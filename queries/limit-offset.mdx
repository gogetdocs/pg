## Using LIMIT and OFFSET in SQL Queries

=====================================================

LIMIT and OFFSET are used to retrieve a portion of the rows generated by a SQL query. Here's a breakdown of how to use them effectively.

### Basic Syntax

---

The basic syntax for using LIMIT and OFFSET is as follows:

```sql
SELECT select_list
FROM table_expression
[ ORDER BY ... ]
[ LIMIT { number | ALL } ] [ OFFSET number ]
```

### LIMIT Clause

---

The LIMIT clause specifies the maximum number of rows to return. If the query yields fewer rows, only those rows will be returned.

**Example:**

Suppose we have a table `employees` with columns `id`, `name`, and `salary`. We want to retrieve the top 5 employees with the highest salary.

```sql
SELECT id, name, salary
FROM employees
ORDER BY salary DESC
LIMIT 5;
```

This query will return the top 5 employees with the highest salary.

### OFFSET Clause

---

The OFFSET clause specifies the number of rows to skip before starting to return rows.

**Example:**

Suppose we want to retrieve the next 5 employees with the highest salary, after skipping the top 5.

```sql
SELECT id, name, salary
FROM employees
ORDER BY salary DESC
OFFSET 5
LIMIT 5;
```

This query will return the next 5 employees with the highest salary, after skipping the top 5.

### Importance of ORDER BY

---

When using LIMIT, it's essential to use an ORDER BY clause to constrain the result rows into a unique order. Otherwise, you'll get an unpredictable subset of the query's rows.

**Example:**

Suppose we want to retrieve the 10th to 20th employees with the highest salary.

```sql
SELECT id, name, salary
FROM employees
ORDER BY salary DESC
OFFSET 9
LIMIT 10;
```

Without the ORDER BY clause, the query would return an unpredictable subset of employees.

### Query Optimizer Considerations

---

The query optimizer takes LIMIT into account when generating query plans. Using different LIMIT/OFFSET values to select different subsets of a query result will give inconsistent results unless you enforce a predictable result ordering with ORDER BY.

**Example:**

Suppose we want to retrieve the top 10 employees with the highest salary, and then retrieve the next 10 employees.

```sql
-- Query 1
SELECT id, name, salary
FROM employees
ORDER BY salary DESC
LIMIT 10;

-- Query 2
SELECT id, name, salary
FROM employees
ORDER BY salary DESC
OFFSET 10
LIMIT 10;
```

If we don't use the same ORDER BY clause in both queries, the results will be inconsistent.

### Performance Considerations

---

A large OFFSET can be inefficient, as the rows skipped by the OFFSET clause still have to be computed inside the server.

**Example:**

Suppose we want to retrieve the 1000th to 1010th employees with the highest salary.

```sql
SELECT id, name, salary
FROM employees
ORDER BY salary DESC
OFFSET 999
LIMIT 10;
```

This query may be slow, as the server has to compute the first 999 rows before returning the desired rows. It's often more efficient to use a different approach, such as using a subquery or a window function.
